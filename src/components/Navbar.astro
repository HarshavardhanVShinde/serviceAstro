---
import { Menu, X } from 'lucide-react';
import Button from './ui/Button';
import AnimatedLogo from './ui/AnimatedLogo';

const navLinks = [
  { name: 'Services', href: '/services' },
  { name: 'Portfolio', href: '/portfolio' },
  { name: 'About', href: '/about' },
  { name: 'Blog', href: '/blog' },
];
---

<header class="fixed top-0 left-0 w-full z-50 transition-all duration-300 border-b border-white/5 bg-primary-900/80 backdrop-blur-md" id="navbar">
  <div class="container mx-auto px-6 h-20 flex justify-between items-center">
    <!-- Logo -->
    <a href="/" class="text-2xl font-bold tracking-tight z-50 relative flex items-center gap-2 group">
      <AnimatedLogo client:load />
    </a>

    <!-- Desktop Nav -->
    <nav class="hidden md:flex items-center space-x-8">
      {navLinks.map(link => (
        <a href={link.href} class="text-text-300 hover:text-accent-400 font-medium transition-colors text-sm uppercase tracking-wide relative group">
          {link.name}
          <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-accent-400 transition-all duration-300 group-hover:w-full"></span>
        </a>
      ))}
      <Button href="/contact" variant="primary" size="sm">
        Start Project
      </Button>
    </nav>

    <!-- Mobile Menu Button -->
    <button id="menu-btn" class="md:hidden text-text-100 hover:text-accent-400 transition-colors focus:outline-none" aria-label="Toggle menu">
      <Menu className="w-8 h-8" />
    </button>
  </div>

  <!-- Mobile Menu Overlay -->
  <div id="mobile-menu" class="fixed inset-0 bg-primary-900/95 backdrop-blur-xl z-40 flex flex-col justify-center items-center opacity-0 pointer-events-none transition-all duration-300">
    <!-- Close Button -->
    <button id="close-menu-btn" class="absolute top-6 right-6 p-2 text-text-100 hover:text-accent-400 transition-colors bg-white/5 rounded-full" aria-label="Close menu">
      <X className="w-8 h-8" />
    </button>
    
    <!-- Mobile Nav Links -->
    <nav class="flex flex-col items-center space-y-8 w-full px-6">
      {navLinks.map((link, index) => (
        <a 
          href={link.href} 
          class="mobile-link text-3xl font-bold text-text-100 hover:text-accent-400 transition-all transform translate-y-4 opacity-0"
          style={`transition-delay: ${index * 50}ms`}
        >
          {link.name}
        </a>
      ))}
      <div class="translate-y-4 opacity-0 delay-300 mobile-cta">
        <Button href="/contact" variant="primary" size="lg" className="mt-8 w-full max-w-xs shadow-xl">
            Start Project
        </Button>
      </div>
    </nav>
  </div>
</header>

<script>
  const menuBtn = document.getElementById('menu-btn');
  const closeMenuBtn = document.getElementById('close-menu-btn');
  const mobileMenu = document.getElementById('mobile-menu');
  const mobileLinks = document.querySelectorAll('.mobile-link');
  const mobileCta = document.querySelector('.mobile-cta');

  function toggleMenu() {
    if (!mobileMenu) return;
    const isOpen = mobileMenu.classList.contains('pointer-events-auto');
    
    if (isOpen) {
      mobileMenu.classList.remove('opacity-100', 'pointer-events-auto');
      mobileMenu.classList.add('opacity-0', 'pointer-events-none');
      mobileLinks.forEach(link => {
        link.classList.remove('translate-y-0', 'opacity-100');
        link.classList.add('translate-y-4', 'opacity-0');
      });
      mobileCta?.classList.remove('translate-y-0', 'opacity-100');
      mobileCta?.classList.add('translate-y-4', 'opacity-0');
      document.body.classList.remove('overflow-hidden');
    } else {
      mobileMenu.classList.add('opacity-100', 'pointer-events-auto');
      mobileMenu.classList.remove('opacity-0', 'pointer-events-none');
      mobileLinks.forEach(link => {
        link.classList.add('translate-y-0', 'opacity-100');
        link.classList.remove('translate-y-4', 'opacity-0');
      });
      mobileCta?.classList.add('translate-y-0', 'opacity-100');
      mobileCta?.classList.remove('translate-y-4', 'opacity-0');
      document.body.classList.add('overflow-hidden');
    }
  }

  menuBtn?.addEventListener('click', toggleMenu);
  closeMenuBtn?.addEventListener('click', toggleMenu);
  
  mobileLinks.forEach(link => {
    link.addEventListener('click', toggleMenu);
  });
</script>
